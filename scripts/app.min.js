!function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{var t;t="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,t.App=e()}}(function(){return function e(t,i,s){function n(a,r){if(!i[a]){if(!t[a]){var c="function"==typeof require&&require;if(!r&&c)return c(a,!0);if(o)return o(a,!0);var p=new Error("Cannot find module '"+a+"'");throw p.code="MODULE_NOT_FOUND",p}var u=i[a]={exports:{}};t[a][0].call(u.exports,function(e){var i=t[a][1][e];return n(i?i:e)},u,u.exports,e,t,i,s)}return i[a].exports}for(var o="function"==typeof require&&require,a=0;a<s.length;a++)n(s[a]);return n}({"D:\\Code\\beccasafan\\PGM-MultiLoc\\src\\scripts\\app\\app.ts":[function(e,t,i){"use strict";var s=e("jquery");e("jquery-migrate"),e("foundation-sites");var n=e("lodash"),o=e("./gmaps.ts"),a=function(){function e(e,t){this.latLng=new google.maps.LatLng(e,t)}return e.prototype.toString=function(){return this.latLng.lat()+", "+this.latLng.lng()},e.prototype.getLatLng=function(){return this.latLng},e}();i.Location=a;var r=function(){function e(){}return e.getHiveRadius=function(e){return(e-1)*Math.sqrt(3)*this.scanRadius+this.scanRadius},e.getStepsToCoverRadius=function(e){return Math.ceil((e-this.scanRadius)/this.scanRadius/Math.sqrt(3)+1)},e.getBeehiveRadius=function(t,i){return Math.floor(3*(t-1)/2-.5)*(e.getHiveRadius(i)-e.hiveOverlap)+e.getHiveRadius(i)},e.getLeapsToCoverRadius=function(t,i){return Math.ceil(2*((t-e.getHiveRadius(i))/(e.getHiveRadius(i)-e.hiveOverlap)+.5)/3+1)},e.distanceBetweenHiveCenters=function(t){var i=(t-1)*(3*this.scanRadius/2)+e.locationAdjustment;return 2*i-e.hiveOverlap},e.scanRadius=900,e.locationAdjustment=Math.sqrt(3)*e.scanRadius/2,e.hiveOverlap=e.scanRadius/2-2*(e.scanRadius-e.locationAdjustment),e}();i.Util=r;var c=function(){function e(){new o.GMaps;s(document).foundation(),Foundation.Abide.defaults.validators.accountColumns=function(e,t,i){var o=s("#accounts").val();if(!t)return!0;if(t&&n.isEmpty(o))return!1;var a=Number(s("#accountColumns").val().split(",").length),r=o.split("\n"),c=n.some(r,function(e){var t=e.split(",").length;return a!==t});return!c},Foundation.Abide.defaults.validators.enoughAccounts=function(e,t,i){var o=Number(s("#workers").val())*Number(s("#hives").val()),a=s("#accounts").val();if(n.isEmpty(a))return!1;var r=a.split("\n").length;return r>=o}}return e}();i.App=c},{"./gmaps.ts":"D:\\Code\\beccasafan\\PGM-MultiLoc\\src\\scripts\\app\\gmaps.ts","foundation-sites":"foundation-sites",jquery:"jquery","jquery-migrate":"jquery-migrate",lodash:"lodash"}],"D:\\Code\\beccasafan\\PGM-MultiLoc\\src\\scripts\\app\\beehive.ts":[function(e,t,i){"use strict";var s=e("./app.ts"),n=e("./hive.ts"),o=e("knockout"),a=e("lodash"),r=function(){function e(e){var t=this;this.options=e,this.hives=o.observableArray([]),this.isEditingHives=!1,this.coveringRadius=s.Util.getBeehiveRadius(this.options.leaps,this.options.steps),this.activeHives=o.computed(function(){return t.getActiveHives()},this,{deferEvaluation:!0}),this.mapObject=new google.maps.Circle({radius:this.coveringRadius,fillColor:"#0000FF",fillOpacity:0,strokeWeight:1,clickable:!0,center:this.options.center.getLatLng(),editable:!0,draggable:!0,zIndex:3}),this.options.map.addMapObject(this.mapObject),this.generateHives(),this.toggleActive(),this.options.map.addListener(this.mapObject,"click",function(){return t.toggleActive()}),this.options.map.addListener(this.mapObject,"radius_changed",function(){t.coveringRadius=t.mapObject.getRadius();var e=s.Util.getLeapsToCoverRadius(t.coveringRadius,t.options.steps);t.options.leaps!==e&&(t.options.leaps=e,t.generateHives())}),this.options.map.addListener(this.mapObject,"center_changed",function(){var e=t.mapObject.getCenter();t.options.center=new s.Location(e.lat(),e.lng()),t.generateHives()})}return e.prototype.getHives=function(){return console.log("getting hives for "+this.options.center.toString()),this.hives()},e.prototype.reset=function(e){void 0===e&&(e=!1);for(var t=0;t<this.hives().length;t++)this.hives()[t].reset();this.hives([]),e&&(this.mapObject=this.options.map.removeMapObject(this.mapObject))},e.prototype.generateHives=function(){var e=this;this.reset();var t=[],i=s.Util.distanceBetweenHiveCenters(this.options.steps),o=function(o,a,r,c){void 0===r&&(r=i),void 0===c&&(c=!0);var p=google.maps.geometry.spherical.computeOffset(o,r,a);return c&&(p=google.maps.geometry.spherical.computeOffset(p,s.Util.locationAdjustment,a+90)),t.push(new n.Hive({center:new s.Location(p.lat(),p.lng()),steps:e.options.steps,map:e.options.map})),p},a=this.options.center.getLatLng();a=o(a,0,0,!1),this.lastHiveCenter=a;for(var r=2;r<=this.options.leaps;r++){a=o(this.lastHiveCenter,0,i),this.lastHiveCenter=a;for(var c=1;c<r;c++)a=o(a,120);for(var p=1;p<r;p++)a=o(a,180);for(var u=1;u<r;u++)a=o(a,240);for(var l=1;l<r;l++)a=o(a,300);for(var h=1;h<r;h++)a=o(a,0);for(var v=2;v<r;v++)a=o(a,60)}return this.hives(t),this.hives()},e.prototype.resize=function(e){this.options.steps=e,this.options.leaps=s.Util.getLeapsToCoverRadius(this.coveringRadius,this.options.steps),this.generateHives()},e.prototype.disableActive=function(){this.isActive=!1,this.isEditingHives&&this.editHives(),this.mapObject.set("fillOpacity",0)},e.prototype.toggleActive=function(e){void 0===e&&(e=!1),this.isActive=!this.isActive,this.mapObject.set("fillOpacity",this.isActive?.3:0),this.options.map.setActiveBeehive(this.isActive?this:null)},e.prototype.editHives=function(){this.isEditingHives=!this.isEditingHives;for(var e=0;e<this.hives().length;e++)this.isEditingHives?this.hives()[e].addListener():this.hives()[e].removeListener();this.mapObject.set("zIndex",this.isEditingHives?1:3),this.mapObject.set("fillOpacity",this.isEditingHives?0:.3)},e.prototype.getActiveHives=function(){return a.filter(this.hives(),function(e){return e.isActive()})},e}();i.Beehive=r},{"./app.ts":"D:\\Code\\beccasafan\\PGM-MultiLoc\\src\\scripts\\app\\app.ts","./hive.ts":"D:\\Code\\beccasafan\\PGM-MultiLoc\\src\\scripts\\app\\hive.ts",knockout:"knockout",lodash:"lodash"}],"D:\\Code\\beccasafan\\PGM-MultiLoc\\src\\scripts\\app\\gmaps.ts":[function(e,t,i){"use strict";var s=e("../config.ts"),n=e("load-google-maps-api"),o=e("./app.ts"),a=e("./map.ts"),r=function(){function e(){var e=this;this.map=new a.Map,n.default({key:s.config.googleMapsKey,libraries:["places","geometry"]}).then(function(t){e.initMap()})}return e.prototype.getMap=function(){return this.map},e.prototype.initMap=function(){var e=this;this.gmap=new google.maps.Map(document.getElementById("map"),{zoom:s.config.zoom,center:new google.maps.LatLng(s.config.latitude,s.config.longitude),mapTypeId:google.maps.MapTypeId.ROADMAP,mapTypeControl:!1});var t=document.getElementById("pac-input");this.gmap.controls[google.maps.ControlPosition.TOP_CENTER].push(document.getElementById("custom-map-controls")),this.gmap.controls[google.maps.ControlPosition.BOTTOM_CENTER].push(document.getElementById("generate-trigger")),this.gmap.controls[google.maps.ControlPosition.LEFT_BOTTOM].push(document.getElementById("github-buttons"));var i=new google.maps.places.Autocomplete(t);i.bindTo("bounds",this.gmap),i.addListener("place_changed",function(){var t=i.getPlace();t.geometry&&(e.gmap.setCenter(t.geometry.location),e.gmap.setZoom(s.config.zoom))}),this.gmap.addListener("click",function(t){e.map.addBeehive(new o.Location(t.latLng.lat(),t.latLng.lng()))}),google.maps.event.addListenerOnce(this.gmap,"idle",function(){e.map.initMap({gmap:e.gmap})})},e}();i.GMaps=r},{"../config.ts":"D:\\Code\\beccasafan\\PGM-MultiLoc\\src\\scripts\\config.ts","./app.ts":"D:\\Code\\beccasafan\\PGM-MultiLoc\\src\\scripts\\app\\app.ts","./map.ts":"D:\\Code\\beccasafan\\PGM-MultiLoc\\src\\scripts\\app\\map.ts","load-google-maps-api":"load-google-maps-api"}],"D:\\Code\\beccasafan\\PGM-MultiLoc\\src\\scripts\\app\\hive.ts":[function(e,t,i){"use strict";var s=e("./app.ts"),n=e("knockout"),o=function(){function e(e){this.options=e,this.isActive=n.observable(!1);var t=this.options.center.getLatLng(),i=s.Util.getHiveRadius(this.options.steps),o=google.maps.geometry.spherical.computeOffset,a=[o(t,i,30),o(t,i,90),o(t,i,150),o(t,i,210),o(t,i,270),o(t,i,330)],r=new google.maps.Polygon({paths:a,fillOpacity:.3,strokeWeight:1,zIndex:2});this.mapObject=r,this.toggleActive(),this.options.map.addMapObject(r)}return Object.defineProperty(e.prototype,"steps",{get:function(){return this.options.steps},enumerable:!0,configurable:!0}),e.prototype.reset=function(){this.mapObject=this.options.map.removeMapObject(this.mapObject)},e.prototype.toggleActive=function(){this.isActive(!this.isActive()),this.mapObject.set("fillColor",this.isActive()?"#0F0":"#F00")},e.prototype.addListener=function(){var e=this;this.activeListener=google.maps.event.addListener(this.mapObject,"click",function(){return e.toggleActive()})},e.prototype.removeListener=function(){this.activeListener.remove()},e.prototype.getCenter=function(){return this.options.center},e}();i.Hive=o},{"./app.ts":"D:\\Code\\beccasafan\\PGM-MultiLoc\\src\\scripts\\app\\app.ts",knockout:"knockout"}],"D:\\Code\\beccasafan\\PGM-MultiLoc\\src\\scripts\\app\\map.ts":[function(e,t,i){"use strict";var s=e("../config.ts"),n=e("./beehive.ts"),o=e("jquery"),a=e("./viewModel.ts"),r=e("knockout"),c=e("lodash"),p=function(){function e(){var e=this;this.beehives=r.observableArray([]),this.activeBeehive=null,this.steps=s.config.steps,this.activeHives=r.computed(function(){return e.getActiveHives()})}return e.prototype.initMap=function(e){var t=this;this.options=e;var i=o("#beehive-control .slider").data("zfPlugin").options;i.end=s.config.maxSteps,i.initialStart=s.config.steps,o("#custom-map-controls").show(),o("#github-buttons").show(),Foundation.reInit(["slider"]),o("#beehive-control .slider").on("moved.zf.slider",function(e){return t.changeSteps(e)}),o("#remove").on("click",function(){return t.removeActiveHive()}),o("#edit-hives").on("click",function(){return t.editHives()}),o("#generate-ui-wrapper").on("open.zf.reveal",function(){c.forEach(o("input,select,textarea","#generate-ui"),function(e){return o("#generate-ui").foundation("validateInput",o(e))})});var n=new a.ViewModel({map:this});r.applyBindings(n,document.getElementsByTagName("body")[0])},e.prototype.addBeehive=function(e){var t=new n.Beehive({map:this,steps:this.steps,leaps:s.config.leaps,center:e});this.beehives.push(t),o("#generate-trigger").show()},e.prototype.addMapObject=function(e){e.set("map",this.options.gmap)},e.prototype.removeMapObject=function(e){return e.set("map",null),e=null},e.prototype.addListener=function(e,t,i){google.maps.event.addListener(e,t,i)},e.prototype.changeSteps=function(e){this.steps=Number(o("#steps").val()),null!==this.activeBeehive&&this.activeBeehive.resize(this.steps)},e.prototype.removeActiveHive=function(){null!==this.activeBeehive&&(this.activeBeehive.reset(!0),this.beehives.splice(this.beehives.indexOf(this.activeBeehive),1),this.activeBeehive=null,o("#remove").hide(),0===this.beehives().length&&o("#generate-trigger").hide())},e.prototype.setActiveBeehive=function(e){null!==this.activeBeehive&&this.activeBeehive.disableActive(),null!==e?(o("#remove").show(),o("#edit-hives").show()):(o("#remove").hide(),o("#edit-hives").hide()),this.activeBeehive=e},e.prototype.editHives=function(){this.activeBeehive.editHives()},e.prototype.getActiveHives=function(){return c.flatten(c.map(this.beehives(),function(e){return e.activeHives()}))},e}();i.Map=p},{"../config.ts":"D:\\Code\\beccasafan\\PGM-MultiLoc\\src\\scripts\\config.ts","./beehive.ts":"D:\\Code\\beccasafan\\PGM-MultiLoc\\src\\scripts\\app\\beehive.ts","./viewModel.ts":"D:\\Code\\beccasafan\\PGM-MultiLoc\\src\\scripts\\app\\viewModel.ts",jquery:"jquery",knockout:"knockout",lodash:"lodash"}],"D:\\Code\\beccasafan\\PGM-MultiLoc\\src\\scripts\\app\\viewModel.ts":[function(e,t,i){"use strict";var s=e("../config.ts"),n=e("jquery"),o=e("knockout"),a=e("lodash"),r=function(){function e(e){var t=this;this.options=e,this.activeHives=o.computed(function(){return t.getActiveHives()}),this.pogomapDirectory=o.observable(""),this.os=o.observable(s.config.os),this.os.subscribe(function(e){t.invalidFields([]),"windows"===t.os()?n("#pogomap-directory").removeAttr("data-abide-ignore"):n("#pogomap-directory").attr("data-abide-ignore",""),a.forEach(n("input,select,textarea","#generate-ui"),function(e){return n("#generate-ui").foundation("validateInput",n(e))})}),this.accountsPerHive=o.observable(s.config.workers),this.accountColumns=o.observable(s.config.accountColumns),this.accountColumns.subscribe(function(e){return n("#generate-ui").foundation("validateInput",n("#accounts"))}),this.accounts=o.observable(""),this.windowsTemplates=new p(s.config.windowsTemplates),this.linuxTemplates=new p(s.config.linuxTemplates),this.activeTemplates=o.computed(function(){return t.getActiveTemplates()}),this.generateScriptPreview=o.computed(function(){return t.generateScriptOutput(!0).replace(/\n/g,"<br />")}),this.invalidFields=o.observableArray([]),this.isValid=o.computed(function(){return 0===t.invalidFields().length}),this.isValid.subscribe(function(e){e?n("#download").show():n("#download").hide()}),n(document).on("valid.zf.abide invalid.zf.abide",function(e){return t.handleFormInputValidation(e)}),n(document).on("formvalid.zf.abide forminvalid.zf.abide",function(e){return t.handleFormValidation(e)})}return e.prototype.handleFormInputValidation=function(e){var t=n(e.target).attr("name"),i=this.invalidFields.indexOf(t);"valid"===e.type?i>=0&&this.invalidFields.splice(i,1):i<0&&this.invalidFields.push(t)},e.prototype.handleFormValidation=function(e){"valid"===e.type&&this.invalidFields([])},e.prototype.getActiveHives=function(){return this.options.map.activeHives()},e.prototype.getActiveTemplates=function(){return"windows"===this.os()?this.windowsTemplates:this.linuxTemplates},e.prototype.generateScriptOutput=function(e){void 0===e&&(e=!0);var t=this.activeTemplates(),i=this.activeHives(),s=this.accounts().split("\n");if(i.length<=0)return"";for(var n="\n"+t.setup.value()+"\n"+this.replaceVariables(t.server.value(),{"pogomap-directory":this.pogomapDirectory(),location:i[0].getCenter().toString()})+"\n"+t.delay.value()+"\n        ",o="",r=0,c=a.map(this.accountColumns().split(","),function(e){return a.trim(e)}),p=0;p<(e?1:i.length);p++){for(var u=[],l=0;l<this.accountsPerHive();l++){var h={};if(s.length>r)for(var v=a.map(s[r].split(","),function(e){return a.trim(e)}),d=0;d<c.length;d++)h[c[d]]=v[d];r++,u.push(this.replaceVariables(t.auth.value(),h))}o+="\n"+this.replaceVariables(t.worker.value(),{"pogomap-directory":this.pogomapDirectory(),index:p+1,location:i[p].getCenter().toString(),steps:i[p].steps,"auth-template":a.join(u," ")})+"\n"+t.delay.value()+"\n            "}return n+o},e.prototype.replaceVariables=function(e,t){return a.forOwn(t,function(t,i){return e=e.replace(new RegExp("{"+i+"}","g"),t)}),e},e.prototype.downloadFile=function(){var e=this.generateScriptOutput(!1);this.downloadScript(e,this.activeTemplates().filename.value())},e.prototype.coordsFile=function(){var e=a.join(a.map(this.activeHives(),function(e){return e.getCenter().toString()}),"\n");this.downloadScript(e,"coords.txt")},e.prototype.downloadScript=function(e,t){var i=new Blob([e],{type:"text/plain"}),s=window.URL.createObjectURL(i),o=n("<a>",{style:"display: none;",download:t,href:s});o.on("click",function(){setTimeout(function(){window.URL.revokeObjectURL(s),o.remove()},50)}),n("#generate-ui").append(o),o[0].dispatchEvent(new MouseEvent("click"))},e}();i.ViewModel=r;var c=function(){function e(e){var t=this;this.defaultValue=e,this.value=o.observable(e),this.isDirty=o.observable(!1),this.value.subscribe(function(e){return t.isDirty(!0)})}return e}();i.Template=c;var p=function(){function e(e){this.setup=new c(e.setup),this.server=new c(e.server),this.worker=new c(e.worker),this.auth=new c(e.auth),this.delay=new c(e.delay),this.filename=new c(e.filename)}return e}();i.Templates=p},{"../config.ts":"D:\\Code\\beccasafan\\PGM-MultiLoc\\src\\scripts\\config.ts",jquery:"jquery",knockout:"knockout",lodash:"lodash"}],"D:\\Code\\beccasafan\\PGM-MultiLoc\\src\\scripts\\config.ts":[function(e,t,i){"use strict";var s=function(){function e(){}return e.googleMapsKey="AIzaSyD8WtOa0Mw_lpppdbXQrORnabd9LK3bri8",e.latitude=38.624691,e.longitude=-90.184776,e.zoom=12,e.leaps=4,e.steps=10,e.maxSteps=25,e.os="windows",e.workers=4,e.accountColumns="username, password",e.windowsTemplates={setup:"taskkill /IM python.exe /F",server:'Start "Server" /d {pogomap-directory} /MIN python.exe runserver.py -os -l "{location}"',worker:'Start "Worker{index}" /d {pogomap-directory} /MIN python.exe runserver.py -ns -l "{location}" -st {steps} {auth-template}',auth:'-u {username} -p "{password}"',delay:"ping 127.0.0.1 -n 6 > null",filename:"launch.bat"},e.linuxTemplates={setup:"#!/usr/bin/env bash",server:"nohup python runserver.py -os -l '{location}' &",worker:"nohup python runserver.py -ns -l '{location}' -st {steps} {auth-template} &",auth:"-u {username} -p '{password}'",delay:"sleep 0.5;",filename:"launch.sh"},e}();i.config=s},{}]},{},["D:\\Code\\beccasafan\\PGM-MultiLoc\\src\\scripts\\app\\app.ts"])("D:\\Code\\beccasafan\\PGM-MultiLoc\\src\\scripts\\app\\app.ts")});
//# sourceMappingURL=app.min.js.map
